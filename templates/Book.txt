<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>STUDYRNA - BOOKS</title>
  <style>
    body {background: linear-gradient(to right, #0f2027, #203a43, #2c5364);font-family: 'Segoe UI', sans-serif;color: white;margin: 0;}
    header {padding: 1rem 2rem;background-color: rgba(255, 255, 255, 0.1);display: flex;justify-content: space-between;align-items: center;backdrop-filter: blur(5px);}
    nav a {color: white;margin-left: 1rem;text-decoration: none;}
    .shelf {padding: 2rem;}
    .shelf-title {font-size: 1.5rem;color: #00e0ff;margin-bottom: 1rem;}
    .book-row {display: flex;gap: 1rem;flex-wrap: wrap;}
    .book {width: 120px;background: #1a1a1a;border: 2px solid #00e0ff;border-radius: 10px;padding: 5px;text-align: center;}
    .book img {width: 100%;height: 130px;object-fit: cover;border-radius: 6px;}
    .book a {display: block;color: #00e0ff;margin-top: 5px;font-size: 0.8rem;text-decoration: none;}
    .upload-form {padding: 2rem;}
    .search-bar {text-align: center;margin-top: 1rem;}
    .footer {padding: 2rem;text-align: center;background: rgba(255, 255, 255, 0.1);color: #aaa;}
    .footer a {color: #00e0ff;text-decoration: none;}
  </style>
</head>
<body>
  <header>
    <h1>üìö Study with RNA</h1>
    <nav>
      <a href="/">Home</a>
      <a href="https://t.me/TEAM_RNA" target="_blank">üì¢ Telegram</a>
      {% if is_admin %}
        <a href="/logout">Logout</a>
      {% else %}
        <a href="/admin">Admin</a>
      {% endif %}
    </nav>
  </header>

  <div class="search-bar">
    <form method="get" action="/">
      <input type="text" name="q" placeholder="üîç Search book..." value="{{ query }}" />
    </form>
  </div>

  {% if is_admin %}
  <section class="upload-form">
    <form action="/upload" method="post" enctype="multipart/form-data">
      <label>Upload Book:</label><br><br>
      <select name="category" required>
        <option value="">-- Select Category --</option>
        <option value="jee">JEE</option>
        <option value="neet">NEET</option>
      </select><br><br>
      <input type="file" name="book" required><br><br>
      <input type="file" name="cover" accept="image/*"><br><br>
      <button type="submit">Upload</button>
    </form>
  </section>
  {% endif %}

  {% for category, books in files.items() %}
  <section class="shelf">
    <div class="shelf-title">{{ category.upper() }} Books</div>
    <div class="book-row">
      {% for book in books %}
      <div class="book">
        {% if book.image %}
          <a href="{{ url_for('view_file', category=category, filename=book.file) }}" target="_blank">
            <img src="{{ url_for('serve_image', category=category, filename=book.image) }}" alt="cover">
          </a>
        {% else %}
          <a href="{{ url_for('view_file', category=category, filename=book.file) }}" target="_blank">
            <div style="height:130px; background:#444; border-radius:6px;">No Image</div>
          </a>
        {% endif %}
        <a href="{{ url_for('view_file', category=category, filename=book.file) }}" target="_blank">üëÅ View</a>
        <a href="{{ url_for('download_file', category=category, filename=book.file) }}">‚¨áÔ∏è Download</a>
      </div>
      {% endfor %}
    </div>
  </section>
  {% endfor %}

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <p style="text-align:center; color:lightgreen;">{{ messages[0] }}</p>
    {% endif %}
  {% endwith %}

  <div class="footer">
    ¬© 2025 Study with RNA | All rights reserved.<br>
    üë©‚Äçüíª MADE BY SUMIT KUMAWAT ‚ù§‚ù§<br>
    üì¢ Join our Telegram: 
    <a href="https://t.me/TEAM_RNA" target="_blank">@TEAM_RNA</a>
  </div>
</body>
</html>
